(function(t){function e(e){for(var a,i,o=e[0],c=e[1],u=e[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(p.length)p.shift()();return n.push.apply(n,u||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,o=1;o<s.length;o++){var c=s[o];0!==r[c]&&(a=!1)}a&&(n.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},r={app:0},n=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"15e8":function(t,e,s){},"1bdd":function(t,e,s){"use strict";var a=s("b6a4"),r=s.n(a);r.a},"2c9f":function(t,e,s){"use strict";var a=s("4f6e"),r=s.n(a);r.a},3872:function(t,e,s){},"3a30":function(t,e,s){},"4f6e":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),r=s("5c96"),n=s.n(r),i=s("9ca8"),o=(s("0fae"),s("c037"),s("ef97"),s("007d"),s("d28f"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)}),c=[],u=(s("5c0b"),s("2877")),l={},d=Object(u["a"])(l,o,c,!1,null,null,null),p=d.exports,m=s("8c4f"),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"home"}},[s("div",{staticClass:"header"},[s("div",{staticClass:"header_left"},[t._v("后台管理")]),s("div",{staticClass:"header_right"},[s("div",{staticClass:"header_right_username"},[t._v("欢迎! "+t._s(t.username))]),s("el-button",{attrs:{type:"primary"},on:{click:t.logout}},[t._v("注销")])],1)]),s("div",{staticClass:"main"},[s("div",{staticClass:"main_item nav"},[s("el-menu",{attrs:{"default-active":"1"}},[s("el-submenu",{attrs:{index:"1"},nativeOn:{click:function(e){return t.onDataCenterClick(e)}}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-s-home"}),s("span",[t._v("数据中心")])]),t._l(t.status.nodes,(function(e,a){return s("el-submenu",{key:a,attrs:{index:"1-"+a.toString()},nativeOn:{click:function(e){return t.onNodeCenterClick(a,e)}}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-s-data"}),s("span",[t._v(t._s(e.name))])]),t._l(e.nodes,(function(e,r){return s("el-menu-item",{key:r,attrs:{index:"1-"+a.toString()+"-"+r.toString()},nativeOn:{click:function(e){return t.onNodeClick(a,r,e)}}},[s("div",{staticStyle:{display:"flex","align-items":"center"}},["running"==e.status?s("i",{staticClass:"el-icon-caret-right",staticStyle:{color:"#21BF4B"}}):t._e(),t._v(" "+t._s(e.name)+" ")])])}))],2)}))],2),s("el-menu-item",{attrs:{index:"2"},nativeOn:{click:function(e){return t.onApplicationCenterClick(e)}}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-menu"}),s("span",[t._v("应用中心")])])],2)],1)],1),s("div",{staticClass:"main_item content"},[0==t.contentType?s("data-center",{attrs:{status:t.status,tasks:t.tasks,logs:t.logs}}):t._e(),1==t.contentType?s("node-center",{attrs:{status:t.nodeCenterStatus}}):t._e(),2==t.contentType?s("node",{attrs:{status:t.nodeStaus,selectNode:t.selectNode,selectNodeCenter:t.selectNodeCenter}}):t._e(),3==t.contentType?s("app-center"):t._e()],1)])])},v=[],f=(s("a4d3"),s("e01a"),s("d28b"),s("99af"),s("4de4"),s("b0c0"),s("4ec9"),s("b680"),s("e439"),s("dbb4"),s("b64b"),s("d3b7"),s("3ca3"),s("159b"),s("ddb0"),s("ade3")),g=(s("96cf"),s("1da1")),C=(s("ac1f"),s("5319"),s("bc3a")),_=s.n(C),b=s("4328"),x=s.n(b),k=_.a.create({baseURL:"/api",withCredentials:!0}),y="";k.interceptors.request.use((function(t){return"get"!==t.method&&(t.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.data=x.a.stringify(t.data)),t.headers["CSRFPreventionToken"]=y,t}),(function(t){return Promise.reject(t)})),k.interceptors.response.use((function(t){return t.data.data.CSRFPreventionToken&&(y=t.data.data.CSRFPreventionToken),t}),(function(t){if(t.response)switch(t.response.status){case 401:return te.$message.error(t.response.statusText),void te.$router.replace({name:"login"});default:te.$message.error(t.response.statusText);break}else te.$message.error(t)}));var w=k,S={LOGIN:"/api2/json/access/ticket",CLUSTER_STATUS:"/api2/json/cluster/status",CLUSTER_RESOURCES:"/api2/json/cluster/resources",CLUSTER_TASKS:"/api2/json/cluster/tasks",CLUSTER_LOG:"/api2/json/cluster/log"},O={USERNAME:"username"},D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",{attrs:{gutter:15}},[s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"健康"}},[s("div",{staticClass:"health"},[s("div",{staticClass:"health_item"},[s("div",{staticClass:"health_item_title"},[t._v("状态")]),s("i",{staticClass:"el-icon-success",staticStyle:{color:"#21BF4B","font-size":"55px"}})]),s("div",{staticClass:"health_item"},[s("div",{staticClass:"health_item_title"},[t._v("节点")]),s("div",{staticClass:"health_item_nodestatus"},[s("div",[s("i",{staticClass:"el-icon-check",staticStyle:{color:"#21BF4B","font-weight":"bold","margin-right":"10px"}}),t._v("在线 ")]),s("div",[t._v(t._s(t.status.health.nodes.online))])]),s("div",{staticClass:"health_item_nodestatus"},[s("div",[s("i",{staticClass:"el-icon-close",staticStyle:{color:"#FF6C59","font-weight":"bold","margin-right":"10px"}}),t._v("离线 ")]),s("div",[t._v(t._s(t.status.health.nodes.offline))])])])])])],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"访客"}},[s("div",{staticClass:"visitor"},[s("div",{staticClass:"visitor_item"},[s("div",{staticClass:"visitor_item_title"},[t._v("虚拟机")]),s("div",{staticClass:"visitor_item_status"},[s("div",[s("i",{staticClass:"el-icon-video-play",staticStyle:{color:"#21BF4B","font-weight":"bold","margin-right":"10px"}}),t._v("运行中 ")]),s("div",[t._v(t._s(t.status.visitor.qemu.running))])]),s("div",{staticClass:"visitor_item_status"},[s("div",[s("i",{staticClass:"el-icon-video-pause",staticStyle:{color:"#CFCFCF","font-weight":"bold","margin-right":"10px"}}),t._v("已停止 ")]),s("div",[t._v(t._s(t.status.visitor.qemu.stopped))])])]),s("div",{staticClass:"visitor_item"},[s("div",{staticClass:"visitor_item_title"},[t._v("LXC容器")]),s("div",{staticClass:"visitor_item_status"},[s("div",[s("i",{staticClass:"el-icon-video-play",staticStyle:{color:"#21BF4B","font-weight":"bold","margin-right":"10px"}}),t._v("运行中 ")]),s("div",[t._v(t._s(t.status.visitor.lxc.running))])]),s("div",{staticClass:"visitor_item_status"},[s("div",[s("i",{staticClass:"el-icon-video-pause",staticStyle:{color:"#CFCFCF","font-weight":"bold","margin-right":"10px"}}),t._v("已停止 ")]),s("div",[t._v(t._s(t.status.visitor.lxc.stopped))])])])])])],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"资源"}},[s("div",{staticClass:"resource"},[s("div",{staticClass:"resource_item"},[s("div",{staticClass:"resource_item_title"},[t._v("CPU")]),s("v-chart",{staticClass:"resource-chart",attrs:{options:t.cpuChartOption}}),s("div",[t._v("of "+t._s(t.status.resource.maxcpu)+" CPU(s)")]),s("div",{staticClass:"resource_item_centertext"},[t._v(t._s(t.status.resource.cpuUsage)+"%")])],1),s("div",{staticClass:"resource_item"},[s("div",{staticClass:"resource_item_title"},[t._v("内存")]),s("v-chart",{staticClass:"resource-chart",attrs:{options:t.memChartOption}}),s("div",[t._v(t._s((t.status.resource.mem/1024/1024/1024).toFixed(2))+" GiB of "+t._s((t.status.resource.maxmem/1024/1024/1024).toFixed(2))+" GiB")]),s("div",{staticClass:"resource_item_centertext"},[t._v(t._s(t.status.resource.memUsage)+"%")])],1),s("div",{staticClass:"resource_item"},[s("div",{staticClass:"resource_item_title"},[t._v("存储")]),s("v-chart",{staticClass:"resource-chart",attrs:{options:t.cpuChartOption}}),s("div",[t._v(t._s((t.status.resource.disk/1024/1024/1024).toFixed(2))+" GiB of "+t._s((t.status.resource.maxdisk/1024/1024/1024).toFixed(2))+" GiB")]),s("div",{staticClass:"resource_item_centertext"},[t._v(t._s(t.status.resource.diskUsage)+"%")])],1)])])],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"节点"}},[s("el-table",{attrs:{data:t.status.nodes,"max-height":"230"}},[s("el-table-column",{attrs:{prop:"name",label:"名称"}}),s("el-table-column",{attrs:{prop:"nodeid",label:"ID"}}),s("el-table-column",{attrs:{prop:"status",label:"状态"}}),s("el-table-column",{attrs:{prop:"ip",label:"服务器地址"}}),s("el-table-column",{attrs:{prop:"cpuUsage",label:"CPU使用率%"}}),s("el-table-column",{attrs:{prop:"memUsage",label:"内存使用率%"}}),s("el-table-column",{attrs:{prop:"diskUsage",label:"硬盘使用率%"}})],1)],1)],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"任务"}},[s("el-table",{attrs:{data:t.tasks,"max-height":"230"}},[s("el-table-column",{attrs:{prop:"starttime",label:"开始时间"}}),s("el-table-column",{attrs:{prop:"endtime",label:"结束时间"}}),s("el-table-column",{attrs:{prop:"node",label:"节点"}}),s("el-table-column",{attrs:{prop:"user",label:"用户名"}}),s("el-table-column",{attrs:{prop:"type",label:"描述"}}),s("el-table-column",{attrs:{prop:"status",label:"状态"}})],1)],1)],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"集群日志"}},[s("el-table",{attrs:{data:t.logs,"max-height":"230"}},[s("el-table-column",{attrs:{prop:"time",label:"时间"}}),s("el-table-column",{attrs:{prop:"node",label:"节点"}}),s("el-table-column",{attrs:{prop:"tag",label:"服务"}}),s("el-table-column",{attrs:{prop:"pid",label:"PID"}}),s("el-table-column",{attrs:{prop:"user",label:"用户名"}}),s("el-table-column",{attrs:{prop:"msg",label:"消息"}})],1)],1)],1)],1)],1)},R=[],j=(s("a9e3"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"datacard"},[s("div",{staticClass:"header"},[t._v(t._s(t.title))]),t._t("default")],2)}),N=[],F={name:"DataCard",props:{title:{type:String,default:""}}},I=F,A=(s("2c9f"),Object(u["a"])(I,j,N,!1,null,"d5074418",null)),T=A.exports,P=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("data-card",{staticClass:"card",attrs:{title:t.title}},[s("v-chart",{staticClass:"chart",attrs:{options:t.option,autoresize:""}})],1)],1)},U=[],E=(s("d81d"),{name:"AreaChartCard",components:{"data-card":T},props:{title:{type:String,default:""},legend:{type:Array,default:function(){return[]}},xAxis:{type:Array,default:function(){return[]}},series:{type:Array,default:function(){return[]}}},computed:{option:function(){var t=this.series.map((function(t){return{name:t.name,type:"line",stack:"总量",areaStyle:{},symbol:"none",data:t.data}}));return{color:["#94AE0A","#115FA6"],tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:this.legend},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:this.xAxis}],yAxis:[{type:"value"}],series:t}}}}),L=E,$=(s("e550"),Object(u["a"])(L,P,U,!1,null,"b611f79e",null)),M=$.exports,q={name:"usage",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,startAngle:180,label:{normal:{show:!1},emphasis:{show:!1}},labelLine:{normal:{show:!1}}};function V(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function B(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?V(Object(s),!0).forEach((function(e){Object(f["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):V(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var G=["#C2DDF2","#F5F5F5"],z=["#FFCC00","#F5F5F5"],J={name:"DataCenter",components:{"data-card":T},props:{status:{type:Object,default:function(){return{health:{status:!0,nodes:{online:0,offline:0}},visitor:{qemu:{running:0,stopped:0},lxc:{running:0,stopped:0}},resource:{cpu:0,maxcpu:0,mem:0,maxmem:0,disk:0,maxdisk:0,cpuUsage:"",memUsage:"",diskUsage:""},nodes:[]}}},tasks:{type:Array,default:function(){return[]}},logs:{type:Array,default:function(){return[]}}},computed:{cpuChartOption:function(){return{series:[B({},q,{color:Number(this.status.resource.cpuUsage)>50?z:G,data:[{value:Number(this.status.resource.cpuUsage),name:"cpu"},{value:100,name:"empty"}]})]}},diskChartOption:function(){return{series:[B({},q,{color:Number(this.status.resource.diskUsage)>50?z:G,data:[{value:this.status.resource.disk,name:"disk"},{value:this.status.resource.maxdisk-this.status.resource.disk,name:"empty"}]})]}},memChartOption:function(){return{series:[B({},q,{color:Number(this.status.resource.memUsage)>50?z:G,data:[{value:this.status.resource.mem,name:"mem"},{value:this.status.resource.maxmem-this.status.resource.mem,name:"empty"}]})]}}},data:function(){return{}}},H=J,K=(s("78bb"),Object(u["a"])(H,D,R,!1,null,"59d5871b",null)),Y=K.exports,W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"node-center"},[s("el-row",{attrs:{gutter:15}},[s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"状态(运行时间: "+Math.floor(t.status.status.uptime/3600/24)+" 天 "+Math.floor((t.status.status.uptime-3600*Math.floor(t.status.status.uptime/3600/24)*24)/3600)+" 时)"}},[s("div",{staticClass:"status"},[s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("CPU利用率")]),s("div",[t._v(t._s((100*t.status.status.cpu).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:100*t.status.status.cpu,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("内存使用率")]),s("div",[t._v(t._s((t.status.status.memory.used/t.status.status.memory.total*100).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:t.status.status.memory.used/t.status.status.memory.total*100,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("硬盘使用率")]),s("div",[t._v(t._s((t.status.status.rootfs.used/t.status.status.rootfs.total*100).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:t.status.status.rootfs.used/t.status.status.rootfs.total*100,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("IO延迟")]),s("div",[t._v(t._s((100*t.status.status.wait).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:100*t.status.status.wait,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("SWAP使用率")]),s("div",[t._v(t._s((t.status.status.swap.used/t.status.status.swap.total*100).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:t.status.status.swap.used/t.status.status.swap.total*100,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item1"},[s("div",[t._v("CPU(s)")]),s("div",[t._v(t._s(t.status.status.cpuinfo.cpus)+" x "+t._s(t.status.status.cpuinfo.model))])]),s("div",{staticClass:"status_item1"},[s("div",[t._v("内核版本")]),s("div",[t._v(t._s(t.status.status.kversion))])]),s("div",{staticClass:"status_item1"},[s("div",[t._v("PVE管理器版本")]),s("div",[t._v(t._s(t.status.status.pveversion))])]),s("div",{staticClass:"status_item1"},[s("div",[t._v("KSM共享")]),s("div",[t._v(t._s((t.status.status.ksm.shared/1024/1024).toFixed(2))+" MiB")])])])])],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"CPU利用率",legend:["IO延迟","CPU使用率"],xAxis:t.chartData.xAxis,series:[{name:"IO延迟",data:t.chartData.ioS},{name:"CPU使用率",data:t.chartData.cpuS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"服务器负载",legend:["平均负荷"],xAxis:t.chartData.xAxis,series:[{name:"平均负荷",data:t.chartData.loadS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"内存使用率",legend:["总额","内存使用"],xAxis:t.chartData.xAxis,series:[{name:"总额",data:t.chartData.memTotalS},{name:"内存使用",data:t.chartData.memS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"网络流量",legend:["netout","netin"],xAxis:t.chartData.xAxis,series:[{name:"netout",data:t.chartData.netoutS},{name:"netin",data:t.chartData.netinS}]}})],1)],1)],1)},X=[],Q={name:"NodeCenter",components:{"data-card":T,"areachart-card":M},props:{status:{type:Object,default:function(){return{status:{},rrdata:[]}}}},computed:{chartData:function(){var t=[],e=[],s=[],a=[],r=[],n=[],i=[],o=[],c=!0,u=!1,l=void 0;try{for(var d,p=this.status.rrdata[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var m=d.value,h=new Date(1e3*m.time);t.push("".concat(h.getFullYear(),"-").concat(h.getMonth()+1,"-").concat(h.getDate()," ").concat(h.getHours(),":").concat(h.getMinutes(),":").concat(h.getSeconds())),e.push(+(100*m.cpu).toFixed(1)),s.push(+(100*m.iowait).toFixed(1)),a.push(+m.loadavg.toFixed(2)),r.push(+(m.memused/1024/1024/1024).toFixed(1)),n.push(+(m.memtotal/1024/1024/1024).toFixed(1)),i.push(+m.netin.toFixed(1)),o.push(+m.netout.toFixed(1))}}catch(v){u=!0,l=v}finally{try{c||null==p.return||p.return()}finally{if(u)throw l}}return{xAxis:t,cpuS:e,ioS:s,loadS:a,memS:r,memTotalS:n,netinS:i,netoutS:o}}},data:function(){return{progressColor:[{color:"#C2DDF2",percentage:50},{color:"#FFCC00",percentage:100}]}}},Z=Q,tt=(s("b384"),Object(u["a"])(Z,W,X,!1,null,"1bd065aa",null)),et=tt.exports,st=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"node-center"},[s("el-row",{attrs:{gutter:15}},[s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("data-card",{staticClass:"card",attrs:{title:"状态(运行时间: "+Math.floor(t.status.status.uptime/3600/24)+" 天 "+Math.floor((t.status.status.uptime-3600*Math.floor(t.status.status.uptime/3600/24)*24)/3600)+" 时)"}},[s("div",{staticClass:"status"},[s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("CPU利用率")]),s("div",[t._v(t._s((100*t.status.status.cpu).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:100*t.status.status.cpu,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item0"},[s("div",{staticClass:"status_item0_top"},[s("div",[t._v("内存使用率")]),s("div",[t._v(t._s((t.status.status.mem/t.status.status.maxmem*100).toFixed(2))+"%")])]),s("el-progress",{staticClass:"status_item0_progress",attrs:{percentage:t.status.status.mem/t.status.status.maxmem*100,color:t.progressColor,"show-text":!1}})],1),s("div",{staticClass:"status_item1"},[s("div",[t._v("状态")]),s("div",[t._v(t._s(t.status.status.status))])]),s("div",{staticClass:"status_item1"},[s("div",[t._v("引导磁盘大小")]),s("div",[t._v(t._s((t.status.status.maxdisk/1024/1024/1024).toFixed(2))+" GiB")])]),s("a",{staticClass:"tonode",attrs:{href:"http://nas.snas.xyz:"+(t.status.status.port||5e3),target:"_blank"}},[t._v("应用")]),s("router-link",{staticClass:"tonode",attrs:{to:{name:"vnc",query:{selectNode:t.selectNode,selectNodeCenter:t.selectNodeCenter}}}},[t._v("VNC")])],1)])],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"CPU利用率",legend:["CPU使用率"],xAxis:t.chartData.xAxis,series:[{name:"CPU使用率",data:t.chartData.cpuS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"内存使用率",legend:["总额","内存使用"],xAxis:t.chartData.xAxis,series:[{name:"总额",data:t.chartData.memTotalS},{name:"内存使用",data:t.chartData.memS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"网络流量",legend:["netout","netin"],xAxis:t.chartData.xAxis,series:[{name:"netout",data:t.chartData.netoutS},{name:"netin",data:t.chartData.netinS}]}})],1),s("el-col",{staticClass:"col",attrs:{md:24,lg:12}},[s("areachart-card",{staticClass:"card",attrs:{title:"磁盘IO",legend:["diskread","diskwrite"],xAxis:t.chartData.xAxis,series:[{name:"diskread",data:t.chartData.diskreadS},{name:"diskwrite",data:t.chartData.diskwriteS}]}})],1)],1)],1)},at=[],rt={name:"Node",components:{"data-card":T,"areachart-card":M},props:{status:{type:Object,default:function(){return{status:{},rrdata:[]}}},selectNode:{type:String},selectNodeCenter:{type:String}},computed:{chartData:function(){var t=[],e=[],s=[],a=[],r=[],n=[],i=[],o=[],c=!0,u=!1,l=void 0;try{for(var d,p=this.status.rrdata[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var m=d.value,h=new Date(1e3*m.time);t.push("".concat(h.getFullYear(),"-").concat(h.getMonth()+1,"-").concat(h.getDate()," ").concat(h.getHours(),":").concat(h.getMinutes(),":").concat(h.getSeconds())),e.push(+(100*m.cpu).toFixed(1)),s.push(+(m.mem/1024/1024/1024).toFixed(1)),a.push(+(m.maxmem/1024/1024/1024).toFixed(1)),m.netin&&(r.push(+m.netin.toFixed(1)),n.push(+m.netout.toFixed(1))),m.diskread&&(i.push(+m.diskread.toFixed(1)),o.push(+m.diskwrite.toFixed(1)))}}catch(v){u=!0,l=v}finally{try{c||null==p.return||p.return()}finally{if(u)throw l}}return{xAxis:t,cpuS:e,memS:s,memTotalS:a,netinS:r,netoutS:n,diskreadS:i,diskwriteS:o}}},data:function(){return{progressColor:[{color:"#C2DDF2",percentage:50},{color:"#FFCC00",percentage:100}]}}},nt=rt,it=(s("1bdd"),Object(u["a"])(nt,st,at,!1,null,"5d001494",null)),ot=it.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"appcenter"}},[a("div",{staticClass:"apps"},[t._l(t.apps,(function(e,s){return a("div",{key:s,staticClass:"apps_item",on:{click:function(s){return t.onAppClick(e)},mouseenter:function(e){return t.onItemMouseOver(s,!0)},mouseleave:function(e){return t.onItemMouseOver(s,!1)}}},[a("img",{staticClass:"apps_item_icon",attrs:{src:"app"+e.icon+".svg"}}),a("div",{staticClass:"apps_item_name"},[t._v(t._s(e.name))]),t.appStatus[s].hover?a("div",{staticClass:"apps_item_edit",on:{click:function(a){return a.stopPropagation(),t.onAppEditClick(e,s)}}},[a("i",{staticClass:"el-icon-s-tools apps_item_edit_icon"})]):t._e(),t.appStatus[s].hover?a("div",{staticClass:"apps_item_close",on:{click:function(e){return e.stopPropagation(),t.onAppDeleteIconClick(s)}}},[a("i",{staticClass:"el-icon-close apps_item_close_icon"})]):t._e()])})),a("div",{staticClass:"apps_add",on:{click:t.onAddClick}},[a("img",{staticClass:"apps_add_img",attrs:{src:s("6828")}})])],2),a("el-dialog",{attrs:{title:"APP",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-input",{staticClass:"dialog_input",attrs:{placeholder:"名称"},model:{value:t.dialogItemInfo.name,callback:function(e){t.$set(t.dialogItemInfo,"name",e)},expression:"dialogItemInfo.name"}}),a("el-input",{staticClass:"dialog_input",attrs:{placeholder:"链接"},model:{value:t.dialogItemInfo.link,callback:function(e){t.$set(t.dialogItemInfo,"link",e)},expression:"dialogItemInfo.link"}}),a("el-select",{staticClass:"dialog_input",attrs:{placeholder:"图标"},model:{value:t.dialogItemInfo.icon,callback:function(e){t.$set(t.dialogItemInfo,"icon",e)},expression:"dialogItemInfo.icon"}},t._l(t.icons,(function(e){return a("el-option",{key:e,staticClass:"option",attrs:{label:e,value:e}},[a("span",{staticClass:"option-label"},[t._v(t._s(e))]),a("img",{staticClass:"option-img",attrs:{src:"app"+e+".svg"}})])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.onAppChangeClick}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:t.deleteDialogStatus.show,width:"30%"},on:{"update:visible":function(e){return t.$set(t.deleteDialogStatus,"show",e)}}},[a("div",[t._v("确认删除?")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.deleteDialogStatus.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.onItemDeleteClick}},[t._v("确 定")])],1)])],1)},ut=[],lt=(s("a434"),s("9911"),13),dt=0,pt=1,mt={name:"AppCenter",data:function(){return{apps:[],appStatus:[],icons:[],dialogVisible:!1,dialogItemInfo:{name:"",link:"",icon:0},dialogType:-1,itemIndex:-1,deleteDialogStatus:{show:!1,index:-1}}},methods:{onAppClick:function(t){window.location=t.link},onAppChangeClick:function(){var t=this.dialogItemInfo,e=t.name,s=t.link,a=t.icon;if(""!=e&&""!=s&&a>=0&&a<=lt){switch(this.dialogType){case dt:this.apps.push(this.dialogItemInfo),this.appStatus.push(this.dialogItemInfo);break;case pt:this.$set(this.apps,this.itemIndex,this.dialogItemInfo);break}this.saveApps(),this.dialogVisible=!1}},onAddClick:function(){this.dialogItemInfo={name:"",link:"",icon:0},this.dialogType=dt,this.dialogVisible=!0},onAppEditClick:function(t,e){this.dialogItemInfo=t,this.itemIndex=e,this.dialogType=pt,this.dialogVisible=!0},onItemMouseOver:function(t,e){this.appStatus[t]&&(this.appStatus[t].hover=e)},onItemDeleteClick:function(){this.apps.splice(this.deleteDialogStatus.index,1),this.appStatus.splice(this.deleteDialogStatus.index,1),this.saveApps(),this.deleteDialogStatus.show=!1},onAppDeleteIconClick:function(t){this.deleteDialogStatus.index=t,this.deleteDialogStatus.show=!0},saveApps:function(){localStorage.setItem("apps",JSON.stringify(this.apps))}},created:function(){for(var t=this,e=0;e<=lt;e++)this.icons.push(e);var s=localStorage.getItem("apps")||'[{"name":"unas","link":"https://nas.snas.xyz:60050","icon":0},{"name":"群晖","link":"nas.snas.xyz:60051","icon":3},{"name":"nextcould","link":"https://nas.snas.xyz:60052","icon":10},{"name":"aria2内网","link":" http://192.168.1.24:6880","icon":9},{"name":"Transmission","link":"nas.snas.xyz:20001","icon":8,"hover":false},{"name":"Ikuai路由","link":"nas.snas.xyz:60002","icon":5,"hover":false},{"name":"PVE虚拟化","link":"https://nas.snas.xyz:8006","icon":1},{"name":"FTP","link":"ftp://nas.snas.xyz:8021","icon":7}]';this.apps=s?JSON.parse(s):[],this.apps.forEach((function(){t.appStatus.push({hover:!1})}))}},ht=mt,vt=(s("91a2"),Object(u["a"])(ht,ct,ut,!1,null,"bf190302",null)),ft=vt.exports;function gt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function Ct(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(s),!0).forEach((function(e){Object(f["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):gt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var _t={name:"Home",components:{"data-center":Y,"node-center":et,node:ot,"app-center":ft},data:function(){return{username:"",status:{health:{status:!0,nodes:{online:0,offline:0}},visitor:{qemu:{running:0,stopped:0},lxc:{running:0,stopped:0}},resource:{cpu:0,maxcpu:0,mem:0,maxmem:0,disk:0,maxdisk:0,cpuUsage:"",memUsage:"",diskUsage:""},nodes:[]},nodeCenterStatus:{status:{},rrdata:[]},selectNodeCenter:"",nodeStaus:{status:{},rrdata:[]},selectNode:"",contentType:-1,timeoutList:[],nodeCenters:[],ports:{},tasks:[],logs:[]}},methods:{logout:function(){this.clearAllTimeout(),this.$router.push({name:"login"})},onDataCenterClick:function(){this.clearAllTimeout(),this.dataCenterRequest()},onNodeCenterClick:function(t,e){var s=this.status.nodes[t].node;s?(this.selectNodeCenter=s,this.clearAllTimeout(),this.nodeCenterRequest(),e.stopPropagation()):this.$message.info("加载中...请稍后再试")},onNodeClick:function(t,e,s){var a=this.status.nodes[t].node,r=this.status.nodes[t].nodes[e].id;a&&r?(this.selectNodeCenter=a,this.selectNode=r,this.clearAllTimeout(),this.nodeRequest(),s.stopPropagation()):this.$message.info("加载中...请稍后再试")},onApplicationCenterClick:function(){this.contentType=3,this.clearAllTimeout()},clearAllTimeout:function(){var t=this;return new Promise((function(e){var s=!0,a=!1,r=void 0;try{for(var n,i=t.timeoutList[Symbol.iterator]();!(s=(n=i.next()).done);s=!0){var o=n.value;clearInterval(o)}}catch(c){a=!0,r=c}finally{try{s||null==i.return||i.return()}finally{if(a)throw r}}t.timeoutList=[],e()}))},getStatusData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n,i,o,c,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get(S.CLUSTER_STATUS);case 2:if(e=t.sent,!e){t.next=25;break}for(s=[],a=!0,r=!1,n=void 0,t.prev=8,i=e.data.data[Symbol.iterator]();!(a=(o=i.next()).done);a=!0)c=o.value,u=c.name,l=c.online,d=c.ip,p=c.nodeid,s.push({name:u,online:l,ip:d,nodeid:p,nodes:[]});t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](8),r=!0,n=t.t0;case 16:t.prev=16,t.prev=17,a||null==i.return||i.return();case 19:if(t.prev=19,!r){t.next=22;break}throw n;case 22:return t.finish(19);case 23:return t.finish(16);case 24:this.status.nodes=s;case 25:case"end":return t.stop()}}),t,this,[[8,12,16,24],[17,,19,23]])})));function e(){return t.apply(this,arguments)}return e}(),getResourcesData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n,i,o,c,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get(S.CLUSTER_RESOURCES);case 2:if(e=t.sent,!e){t.next=66;break}s=new Map,this.status.nodes.forEach((function(t,e){s.set(t.name,e)})),a={qemu:{running:0,stopped:0},lxc:{running:0,stopped:0}},r={online:0,offline:0},n={cpu:0,maxcpu:0,mem:0,maxmem:0,disk:0,maxdisk:0,cpuUsage:"",memUsage:"",diskUsage:""},i=!0,o=!1,c=void 0,t.prev=12,u=e.data.data[Symbol.iterator]();case 14:if(i=(l=u.next()).done){t.next=45;break}d=l.value,t.t0=d.type,t.next="node"===t.t0?19:"qemu"===t.t0?33:"lxc"===t.t0?36:"stroge"===t.t0?39:41;break;case 19:return p=this.status.nodes[s.get(d.node)],p=Ct({},p,{},d),p.cpuUsage=(100*d.cpu).toFixed(1),p.memUsage=(d.mem/d.maxmem*100).toFixed(1),p.diskUsage=(d.disk/d.maxdisk*100).toFixed(1),this.$set(this.status.nodes,s.get(d.node),p),"online"===d.status?r.online++:r.offline++,n.cpu+=d.cpu,n.maxcpu+=d.maxcpu,n.mem+=d.mem,n.maxmem+=d.maxmem,n.disk+=d.disk,n.maxdisk+=d.maxdisk,t.abrupt("break",42);case 33:return"running"===d.status?a.qemu.running++:a.qemu.stopped++,this.status.nodes[s.get(d.node)].nodes.push(d),t.abrupt("break",42);case 36:return"running"===d.status?a.lxc.running++:a.lxc.stopped++,this.status.nodes[s.get(d.node)].nodes.push(d),t.abrupt("break",42);case 39:return this.status.nodes[s.get(d.node)].nodes.push(d),t.abrupt("break",42);case 41:return t.abrupt("break",42);case 42:i=!0,t.next=14;break;case 45:t.next=51;break;case 47:t.prev=47,t.t1=t["catch"](12),o=!0,c=t.t1;case 51:t.prev=51,t.prev=52,i||null==u.return||u.return();case 54:if(t.prev=54,!o){t.next=57;break}throw c;case 57:return t.finish(54);case 58:return t.finish(51);case 59:this.status.visitor=a,this.status.health.nodes=r,n.cpuUsage=(100*n.cpu).toFixed(1),n.memUsage=(n.mem/n.maxmem*100).toFixed(1),n.diskUsage=(n.disk/n.maxdisk*100).toFixed(1),this.status.resource=n,this.saveNodesForPorts();case 66:case"end":return t.stop()}}),t,this,[[12,47,51,59],[52,,54,58]])})));function e(){return t.apply(this,arguments)}return e}(),getNodeCenterStatusData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get("/api2/json/nodes/".concat(this.selectNodeCenter,"/status"));case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:s=e.data.data,this.nodeCenterStatus.status=s;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getNodeCenterRRdata:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get("/api2/json/nodes/".concat(this.selectNodeCenter,"/rrddata?timeframe=hour&cf=AVERAGE"));case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:s=e.data.data,this.nodeCenterStatus.rrdata=s;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getNodeStatusData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get("/api2/json/nodes/".concat(this.selectNodeCenter,"/").concat(this.selectNode,"/status/current"));case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:s=e.data.data,this.nodeStaus.status=s,this.nodeStaus.status.port=this.ports[this.selectNode]||5e3;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getNodeRRdata:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get("/api2/json/nodes/".concat(this.selectNodeCenter,"/").concat(this.selectNode,"/rrddata?timeframe=hour&cf=AVERAGE"));case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:s=e.data.data,this.nodeStaus.rrdata=s;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),dataCenterRequest:function(){var t=this;this.contentType=0,this.getStatusData(),this.getResourcesData(),this.getTasksData(),this.getLogsData(),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getStatusData();case 2:return e.next=4,t.getResourcesData();case 4:case"end":return e.stop()}}),e)}))),5e3)),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getTasksData();case 2:return e.next=4,t.getLogsData();case 4:case"end":return e.stop()}}),e)}))),6e4))},nodeCenterRequest:function(){var t=this;this.contentType=1,this.getNodeCenterStatusData(),this.getNodeCenterRRdata(),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getNodeCenterStatusData();case 2:case"end":return e.stop()}}),e)}))),5e3)),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getNodeCenterRRdata();case 2:case"end":return e.stop()}}),e)}))),5e3))},nodeRequest:function(){var t=this;this.contentType=2,this.getNodeStatusData(),this.getNodeRRdata(),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getNodeStatusData();case 2:case"end":return e.stop()}}),e)}))),5e3)),this.timeoutList.push(setInterval(Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getNodeRRdata();case 2:case"end":return e.stop()}}),e)}))),5e3))},saveNodesForPorts:function(){var t=[],e=!0,s=!1,a=void 0;try{for(var r,n=this.status.nodes[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var i=r.value,o=[],c=!0,u=!1,l=void 0;try{for(var d,p=i.nodes[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var m=d.value;o.push({id:m.id,name:m.name})}}catch(h){u=!0,l=h}finally{try{c||null==p.return||p.return()}finally{if(u)throw l}}t.push({node:i.node,nodes:o})}}catch(h){s=!0,a=h}finally{try{e||null==n.return||n.return()}finally{if(s)throw a}}this.nodeCenters.length!=t.length&&(this.nodeCenters=t,localStorage.setItem("nodeCenters",JSON.stringify(t)))},getTasksData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get(S.CLUSTER_TASKS);case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:for(s=e.data.data,a=!0,r=!1,n=void 0,t.prev=9,i=s[Symbol.iterator]();!(a=(o=i.next()).done);a=!0)c=o.value,c.starttime=this.formatTime(c.starttime),c.endtime=this.formatTime(c.endtime);t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](9),r=!0,n=t.t0;case 17:t.prev=17,t.prev=18,a||null==i.return||i.return();case 20:if(t.prev=20,!r){t.next=23;break}throw n;case 23:return t.finish(20);case 24:return t.finish(17);case 25:this.tasks=s;case 26:case"end":return t.stop()}}),t,this,[[9,13,17,25],[18,,20,24]])})));function e(){return t.apply(this,arguments)}return e}(),getLogsData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.get(S.CLUSTER_LOG);case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:for(s=e.data.data,a=!0,r=!1,n=void 0,t.prev=9,i=s[Symbol.iterator]();!(a=(o=i.next()).done);a=!0)c=o.value,c.time=this.formatTime(c.time);t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](9),r=!0,n=t.t0;case 17:t.prev=17,t.prev=18,a||null==i.return||i.return();case 20:if(t.prev=20,!r){t.next=23;break}throw n;case 23:return t.finish(20);case 24:return t.finish(17);case 25:this.logs=s;case 26:case"end":return t.stop()}}),t,this,[[9,13,17,25],[18,,20,24]])})));function e(){return t.apply(this,arguments)}return e}(),formatTime:function(t){var e=new Date(1e3*t);return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())}},created:function(){this.username=localStorage.getItem(O.USERNAME)||""},mounted:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.post(S.LOGIN,{username:this.username,password:localStorage.getItem("password")});case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:s=e.data.data,document.cookie="PVEAuthCookie=".concat(s.ticket),a=localStorage.getItem("ports"),a&&(this.ports=JSON.parse(a)),this.dataCenterRequest();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){this.clearAllTimeout()}},bt=_t,xt=(s("703c"),Object(u["a"])(bt,h,v,!1,null,"3b92950e",null)),kt=xt.exports,yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"login"}},[s("el-card",[s("div",{attrs:{slot:"header"},slot:"header"},[s("div",{staticClass:"header"},[t._v("登录")])]),s("div",[s("el-input",{staticClass:"input",attrs:{placeholder:"用户名","prefix-icon":"el-icon-user"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),s("el-input",{staticClass:"input",attrs:{placeholder:"密码","show-password":"","prefix-icon":"el-icon-lock"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),s("el-button",{staticClass:"login-btn",attrs:{type:"primary",loading:t.loginLoading},on:{click:t.onLoginClick}},[t._v("登录")])],1)])],1)},wt=[],St={name:"Login",data:function(){return{username:"",password:"",loginLoading:!1}},methods:{onLoginClick:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loginLoading=!0,t.next=3,w.post(S.LOGIN,{password:this.password,username:this.username,realm:"pam"});case 3:e=t.sent,this.loginLoading=!1,e&&(s=e.data.data,a=new Date,r=a.getTime(),n=r+36e8,a.setTime(n),document.cookie="PVEAuthCookie=".concat(s.ticket),localStorage.setItem("password",s.ticket),localStorage.setItem(O.USERNAME,s.username),this.$router.replace({name:"home"}));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},Ot=St,Dt=(s("75dc"),Object(u["a"])(Ot,yt,wt,!1,null,"655547fc",null)),Rt=Dt.exports,jt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._v("Oh Oh Oh, 这儿没路")])},Nt=[],Ft={name:"NotFound"},It=Ft,At=Object(u["a"])(It,jt,Nt,!1,null,"3ffc6f04",null),Tt=At.exports,Pt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"setports"},[t._l(t.nodeCenters,(function(e,a){return s("div",{key:a,staticClass:"nodecenter"},[s("div",{staticClass:"nodecenter_title"},[t._v(t._s(e.node))]),t._l(e.nodes,(function(e,a){return s("div",{key:a,staticClass:"node"},[s("div",{staticClass:"node_t"},[t._v(t._s(e.id))]),s("div",{staticClass:"node_t"},[t._v(t._s(e.name))]),s("input",{attrs:{type:"number",placeholder:"填写端口"},domProps:{value:t.ports[e.id]||5e3},on:{input:function(s){return t.portChange(s,e.id)}}})])}))],2)})),s("button",{on:{click:t.save}},[t._v("保存")])],2)},Ut=[],Et={name:"SetPort",data:function(){return{nodeCenters:[],ports:{}}},methods:{portChange:function(t,e){this.ports[e]=+t.target.value},save:function(){localStorage.setItem("ports",JSON.stringify(this.ports)),this.$message("保存成功")}},mounted:function(){localStorage.getItem("nodeCenters")&&(this.nodeCenters=JSON.parse(localStorage.getItem("nodeCenters"))),localStorage.getItem("ports")&&(this.ports=JSON.parse(localStorage.getItem("ports")))}},Lt=Et,$t=(s("7475"),Object(u["a"])(Lt,Pt,Ut,!1,null,"313a5716",null)),Mt=$t.exports,qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{ref:"view",attrs:{id:"view"}})])},Vt=[],Bt=s("eeac"),Gt={name:"VNC",data:function(){return{selectNodeCenter:"",selectNode:"",vncData:{},rfb:null}},methods:{getVNCData:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,w.post("/api2/json/nodes/".concat(this.selectNodeCenter,"/").concat(this.selectNode,"/vncproxy"),{websocket:1});case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:this.vncData=e.data.data,s=this.vncData,a=s.ticket,r=s.port,this.rfb=new Bt["a"](this.$refs.view,"wss://nas.snas.xyz:8006/api2/json/nodes/".concat(this.selectNodeCenter,"/").concat(this.selectNode,"/vncwebsocket?port=").concat(r,"&vncticket=").concat(encodeURIComponent(a)),{credentials:{password:a}});case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),disconect:function(){this.rfb.disconect()}},mounted:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$route.query,s=e.selectNodeCenter,a=e.selectNode,this.selectNodeCenter=s,this.selectNode=a,t.next=5,this.getVNCData();case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){this.disconect()}},zt=Gt,Jt=(s("df14"),Object(u["a"])(zt,qt,Vt,!1,null,"1f2e7884",null)),Ht=Jt.exports;a["default"].use(m["a"]);var Kt=[{path:"/",name:"home",component:kt},{path:"/login",name:"login",component:Rt},{path:"/setport",name:"setport",component:Mt},{path:"/vnc",name:"vnc",component:Ht},{path:"*",name:"notfound",component:Tt}],Yt=new m["a"]({mode:"history",base:"/",routes:Kt}),Wt=Yt,Xt=s("2f62");a["default"].use(Xt["a"]);var Qt=new Xt["a"].Store({state:{},mutations:{},actions:{},modules:{}});a["default"].config.productionTip=!1,a["default"].use(n.a),a["default"].component("v-chart",i["a"]);var Zt=new a["default"]({router:Wt,store:Qt,render:function(t){return t(p)}}).$mount("#app"),te=e["default"]=Zt},5919:function(t,e,s){},"5c0b":function(t,e,s){"use strict";var a=s("9c0c"),r=s.n(a);r.a},6828:function(t,e,s){t.exports=s.p+"img/add.2c83c60d.svg"},"6eaa":function(t,e,s){},"703c":function(t,e,s){"use strict";var a=s("5919"),r=s.n(a);r.a},7475:function(t,e,s){"use strict";var a=s("15e8"),r=s.n(a);r.a},"75dc":function(t,e,s){"use strict";var a=s("3a30"),r=s.n(a);r.a},"78bb":function(t,e,s){"use strict";var a=s("d396"),r=s.n(a);r.a},"91a2":function(t,e,s){"use strict";var a=s("6eaa"),r=s.n(a);r.a},"9c0c":function(t,e,s){},b384:function(t,e,s){"use strict";var a=s("dea9"),r=s.n(a);r.a},b6a4:function(t,e,s){},d396:function(t,e,s){},d5d6:function(t,e,s){},dea9:function(t,e,s){},df14:function(t,e,s){"use strict";var a=s("3872"),r=s.n(a);r.a},e550:function(t,e,s){"use strict";var a=s("d5d6"),r=s.n(a);r.a}});
//# sourceMappingURL=app.266b58f0.js.map